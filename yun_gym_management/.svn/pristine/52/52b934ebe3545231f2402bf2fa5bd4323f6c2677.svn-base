<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yun.mapper.UserShowMapper">
	
	<!-- 查询会员秀 -->
	<select id="listUserShowInfo" resultType="UserShow">
		select
			id,
			nickname,
			sex,
			image,
			signature
		from user_show
		where gym_addr = #{gymAddr}
		<if test="keyword != null and keyword != ''">
			and concat(nickname,signature) like '%${keyword}%'
		</if>
		<if test="sex == '2'.toString()">
			and sex = 1
		</if>
		<if test="sex == '3'.toString()">
			and sex = 0
		</if>
		limit ${pageNum}, ${pageSize}
	</select>
	
	<!-- 删除会员秀 -->
	<delete id="delUserShow">
		delete from user_show where id = #{value}
	</delete>
	
	<!-- 查询要修改的会员秀 -->
	<select id="getUserShow" resultType="UserShow">
		SELECT
			id,
			nickname,
			sex,
			image,
			signature,
			gym_addr
		FROM
			user_show
		WHERE id = #{value}
	</select>
	
	<!-- 修改会员秀 -->
	<update id="updateUserShow">
		update user_show
		<set>
			<if test="nickname != null and nickname != ''">
				nickname = #{nickname}, 
			</if>
			<if test="image != null and image != ''">
				image = #{image}, 
			</if>
			<if test="sex != null and sex != ''">
				sex = #{sex}, 
			</if>
			<if test="signature != null and signature != ''">
				signature = #{signature}, 
			</if>
		</set>
		where id = #{id}
		and gym_addr = #{gymAddr}
	</update>
	
	<!-- 查询会员秀总数 -->
	<select id="getUserShowCount" resultType="int">
		select count(1) from user_show where gym_addr = #{gymAddr}
		<if test="keyword != null and keyword != ''">
			and concat(nickname,signature) like '%${keyword}%'
		</if>
		<if test="sex == '2'.toString()">
			and sex = 1
		</if>
		<if test="sex == '3'.toString()">
			and sex = 0
		</if>
	</select>
	
	<!-- 新增会员秀 -->
	<insert id="saveUserShow">
		insert into user_show (
			nickname,
			sex,
			image,
			signature,
			create_time,
			gym_addr
		) values (
			#{nickname},
			#{sex},
			#{image},
			#{signature},
			now(),
			#{gymAddr}
		)
	</insert>

</mapper>