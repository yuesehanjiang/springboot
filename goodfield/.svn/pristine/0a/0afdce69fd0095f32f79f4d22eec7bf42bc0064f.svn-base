webpackJsonp([34],{"1Xa9":function(s,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=e("t5DY"),o=e("y6zN"),r=e("vMJZ"),l=e("/pQn"),i={components:{Toast:e("hNqL").a},data:function(){var s=this;return{oldPassForm:{oldPassword:""},oldPassRules:{oldPassword:Object(l.c)()},ruleForm:{captcha:"",newPassword:"",confirmPassword:""},rules:{captcha:Object(l.b)(),newPassword:Object(l.c)(),confirmPassword:[{required:!0,message:"确认密码不能为空",trigger:"blur"},{required:!0,trigger:"blur",validator:function(t,e,a){s.ruleForm.newPassword===s.ruleForm.confirmPassword?a():a(new Error("两次密码不一致"))}}]},toastStatus:!1,toastData:{},sendSmsStatus:!1,sendSmsTips:"发送验证码",count:60,phone:"",account:""}},mounted:function(){var s=Object(o.a)();this.userData=s,this.phone=s.phone,this.account=s.account},methods:{sendSms:function(){var s=this;this.$refs.oldPassForm.validate(function(t){if(!s.sendSmsStatus&&t){var e={phone:s.phone};s.cutdownTime(),Object(a.b)(e).then(function(t){"200"===t.code?s.setToastData({message:t.message,type:"success"}):s.setToastData({message:t.message,type:"fail"})})}})},cancel:function(){this.myCroppa.remove()},confirm:function(){var s=this;this.$refs.oldPassForm.validate(function(t){s.$refs.ruleForm.validate(function(e){if(e&&t){var a={user_id:Object(o.a)().id,phone:s.phone,original:s.oldPassForm.oldPassword,code:s.ruleForm.captcha,password:s.ruleForm.newPassword,account:s.userData.account};Object(r.h)(a).then(function(t){"200"===t.code?s.setToastData({message:"密码修改成功，需要重新登陆。",callback:function(){Object(o.b)("user")}}):s.setToastData({message:t.message,type:"fail"})})}})})},resetForm:function(){this.$refs.ruleForm.resetFields()},cutdownTime:function(){this.sendSmsStatus=!0,this.sendSmsTips="倒计时"+this.count+"秒",this.count=this.count-1,this.timer=setTimeout(this.cutdownTime,1e3),this.count<0&&(this.sendSmsTips="发送验证码",this.count=60,this.sendSmsStatus=!1,clearTimeout(this.timer))},setToastData:function(s){var t=this,e=s.message,a=s.type,o=s.callback;this.toastStatus=!0,this.$set(this.toastData,"message",e),this.$set(this.toastData,"type",a),setTimeout(function(){t.toastStatus=!1,o()},1200)}}},n={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"form-container"},[e("h4",{staticClass:"form-title"},[s._v("修改密码")]),s._v(" "),e("div",{staticClass:"form-item"},[e("span",{staticClass:"form-label"},[s._v("登录账号：")]),s._v(" "),e("span",{staticClass:"form-value"},[s._v(s._s(s.account))])]),s._v(" "),e("div",{staticClass:"form-item"},[e("span",{staticClass:"form-label"},[s._v("绑定手机号：")]),s._v(" "),e("span",{staticClass:"form-value"},[s._v(s._s(s.phone))])]),s._v(" "),e("el-form",{ref:"oldPassForm",staticClass:"form",attrs:{"label-width":"120px","label-position":"left",model:s.oldPassForm,rules:s.oldPassRules}},[e("el-form-item",{staticStyle:{width:"370px"},attrs:{label:"原密码:",prop:"oldPassword"}},[e("el-input",{attrs:{type:"password",placeholder:"密码由 8 - 20 位字母和数字组成"},model:{value:s.oldPassForm.oldPassword,callback:function(t){s.$set(s.oldPassForm,"oldPassword",t)},expression:"oldPassForm.oldPassword"}})],1)],1),s._v(" "),e("el-form",{ref:"ruleForm",staticClass:"form",attrs:{model:s.ruleForm,rules:s.rules,"label-position":"left","label-width":"120px"}},[e("el-form-item",{staticStyle:{width:"370px",position:"relative"},attrs:{label:"验证码:",prop:"captcha"}},[e("el-input",{attrs:{maxlength:6,placeholder:"验证码必须是 6 位数字"},model:{value:s.ruleForm.captcha,callback:function(t){s.$set(s.ruleForm,"captcha",t)},expression:"ruleForm.captcha"}}),s._v(" "),e("span",{staticClass:"send-code",class:{active:s.sendSmsStatus},on:{click:s.sendSms}},[s._v(s._s(s.sendSmsTips))])],1),s._v(" "),e("el-form-item",{staticStyle:{width:"370px"},attrs:{label:"新密码:",prop:"newPassword"}},[e("el-input",{attrs:{maxlength:20,type:"password",placeholder:"密码由 8 - 20 位字母和数字组成"},model:{value:s.ruleForm.newPassword,callback:function(t){s.$set(s.ruleForm,"newPassword",t)},expression:"ruleForm.newPassword"}})],1),s._v(" "),e("el-form-item",{staticStyle:{width:"370px"},attrs:{label:"确认新密码:",prop:"confirmPassword"}},[e("el-input",{attrs:{type:"password",maxlength:20,placeholder:"密码由 8 - 20 位字母和数字组成"},model:{value:s.ruleForm.confirmPassword,callback:function(t){s.$set(s.ruleForm,"confirmPassword",t)},expression:"ruleForm.confirmPassword"}})],1)],1),s._v(" "),e("div",{staticClass:"form-footer"},[e("span",{staticClass:"cancel-button",on:{click:s.resetForm}},[s._v("重置")]),s._v(" "),e("span",{staticClass:"confirm-button",on:{click:s.confirm}},[s._v("确定")])]),s._v(" "),s.toastStatus?e("toast",{attrs:{message:s.toastData.message,type:s.toastData.type}}):s._e()],1)},staticRenderFns:[]};var c=e("VU/8")(i,n,!1,function(s){e("nErZ")},"data-v-3e16003a",null);t.default=c.exports},nErZ:function(s,t){}});
//# sourceMappingURL=34.65790a23a69420f36976.js.map