webpackJsonp([21],{"8KkA":function(e,t){},DQey:function(e,t,a){"use strict";t.a=function(e){return Object(s.a)({method:"post",url:"/goodfield/web/admission/getIdentityInfo",data:e})},t.b=function(e){return Object(s.a)({method:"post",url:"/goodfield/web/admission/getIdentityInfoDetails",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:e,transformRequest:[function(e){var t=[],a=function e(a,s){if(s instanceof Object)for(var i in s)e(a+"["+i+"]",s[i]);else void 0!==s&&null!==s&&t.push(a+"="+encodeURIComponent(s))};for(var s in e)e.hasOwnProperty(s)&&a(s,e[s]);return t.join("&")}]})};var s=a("vLgD")},JLE2:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("aZNZ"),i=a("y6zN"),r=a("oAV5"),n=a.n(r),o=a("DQey"),l={components:{Breadcrumb:s.a},data:function(){var e=this.$route.query;this.defaultDay=new Date((new Date).getTime()-864e5);var t=["",""];return e.datetime?t=[e.datetime,e.datetime]:e.startTime&&e.endTime&&(t=[e.startTime,e.endTime]),{loading:!0,isEmpty:!1,listData:{},stores:[],datetime:t,stores_id:"",user_type:"",detail:["0","0","0"],keyword:"",token:{}}},computed:{exportHref:function(){var e={user_id:this.token.id,pageNum:"0",pageSize:"10",user_type:"1"},t=Object.assign({},e,this.$route.query);return delete t.pageNum,delete t.pageSize,"/goodfield/web/admission/export?"+Object.keys(t).map(function(e){return e+"="+(t[e]||"")}).join("&")}},watch:{stores_id:function(e){this.easyQuery({pageNum:0,stores_id:void 0===e?"":String(e)})},user_type:function(e){this.easyQuery({pageNum:0,user_type:void 0===e?"":String(e)})},keyword:function(e){this.easyQuery({pageNum:0,keyword:void 0===e?"":String(e)})},$route:function(e){var t=e.query;this.getList(Object.assign({},t)),t.datetime?this.datetime=[t.datetime,t.datetime]:t.startTime&&t.endTime&&(this.datetime=[t.startTime,t.endTime])}},mounted:function(){this.token=Object(i.a)();var e=this.$route.query;this.getList(Object.assign({},e))},methods:{handleSearch:n.a.throttle(function(e){this.keyword=e.target.value},1e3,{leading:!1}),dateChange:function(e){e[0]===e[1]?this.easyQuery({pageNum:0,datetime:e[0],startTime:"",endTime:""}):this.easyQuery({pageNum:0,datetime:"",startTime:e[0],endTime:e[1]})},easyQuery:function(e){var t=this.$route.query,a=Object.assign({},t,e);this.$router.push({path:this.$route.path,query:a})},getList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,t.user_id=this.token.id,t.pageNum=t.pageNum||"0",t.pageSize=t.pageSize||"10",t.user_type=t.user_type||"1",t.startTime||t.endTime||t.datetime||(t.datetime=""),Promise.all([Object(o.b)(t),Object(o.a)(t)]).then(function(t){200===Number(t[0].code)&&200===Number(t[1].code)?(e.isEmpty=!1,e.listData=e.countIndex(t[0]),e.stores=t[0].roles,e.detail=t[0].size):201===Number(t[0].code)?(e.stores=t[0].data,e.isEmpty=!0,e.listData={},e.detail=["0","0","0"]):200!==Number(t[0].code)?(e.isEmpty=!0,e.listData={},e.detail=["0","0","0"],e.$message({message:t[0].message,type:"error"})):(e.detail=["0","0","0"],e.isEmpty=!0,e.$message({message:t[1].message,type:"error"})),e.loading=!1})},countIndex:function(e){var t=e.pageSize,a=e.pageNum;return e.data.forEach(function(e,s){e.index=t*a+s+1}),e},pageNumChange:function(e){this.easyQuery({pageNum:String(e-1)})},pageSizeChange:function(e){this.easyQuery({pageNum:String(0),pageSize:e})}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"screen-container"},[a("Breadcrumb",[a("router-link",{attrs:{tag:"li",to:"/user/statistics"}},[e._v("入场人数统计")]),e._v(" "),a("li",[e._v("人次详情")])],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"screen-body"},[a("div",{staticClass:"screen-body-header"},[a("DatePicker",{staticClass:"query-date",attrs:{type:"daterange",size:"default",transfer:!1,placeholder:"选择日期",editable:!1,value:e.datetime},on:{"on-change":e.dateChange}}),e._v(" "),a("Select",{staticClass:"query-select",attrs:{size:"default",clearable:!0,placeholder:"全部门店",transfer:!1,value:e.$route.query.stores_id},on:{"on-change":function(t){e.stores_id=t}}},e._l(e.stores,function(t){return a("Option",{key:t.stores_id,attrs:{value:t.stores_id}},[e._v(e._s(t.stores_name))])})),e._v(" "),a("Select",{staticClass:"query-select",attrs:{size:"default",clearable:!0,placeholder:"会员类型",transfer:!1,value:e.$route.query.user_type||"1"},on:{"on-change":function(t){e.user_type=t}}},[a("Option",{attrs:{value:"0"}},[e._v("曾会员")]),e._v(" "),a("Option",{attrs:{value:"1"}},[e._v("会员")]),e._v(" "),a("Option",{attrs:{value:"2"}},[e._v("非会员")])],1),e._v(" "),a("Input",{staticStyle:{width:"200px"},attrs:{size:"default",prefix:"ios-search",placeholder:"姓名/ID/卡号搜索",value:e.$route.query.keyword},on:{"on-change":e.handleSearch}}),e._v(" "),e.listData.data&&e.listData.data.length?a("a",{staticClass:"export-table",attrs:{href:e.exportHref}},[e._v("导出表格")]):e._e(),e._v(" "),a("div",{staticClass:"button-group"},[a("button",{staticClass:"check-detail detail-3"},[e._v("非会员："+e._s(String(e.detail[2]))+"人次")]),e._v(" "),a("button",{staticClass:"check-detail detail-2"},[e._v("曾会员："+e._s(String(e.detail[1]))+"人次")]),e._v(" "),a("button",{staticClass:"check-detail detail-1"},[e._v("会员："+e._s(String(e.detail[0]))+"人次")])])],1),e._v(" "),a("div",{staticClass:"screen-body-container"},[a("el-table",{staticStyle:{"text-align":"center"},attrs:{"header-cell-style":{"text-align":"center"},height:"100%",data:e.listData.data,border:""}},[a("el-table-column",{attrs:{prop:"index",width:"70",label:"序号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"stores_name",label:"门店"}}),e._v(" "),a("el-table-column",{attrs:{prop:"user_name",label:"会员姓名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"user_id",label:"会员ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"user_card",label:"卡号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"user_in_time",label:"入场时间"}})],1)],1),e._v(" "),e.isEmpty?e._e():a("div",{staticClass:"screen-body-footer"},[a("Page",{attrs:{total:Number(e.listData.total),current:Number(e.listData.pageNum)+1,"page-size":Number(e.listData.pageSize),"show-sizer":"","show-elevator":"","show-total":"",transfer:!1},on:{"on-change":e.pageNumChange,"on-page-size-change":e.pageSizeChange}})],1)])],1)},staticRenderFns:[]};var d=a("VU/8")(l,u,!1,function(e){a("8KkA")},"data-v-d72e1950",null);t.default=d.exports}});
//# sourceMappingURL=21.a8cc573cf3ce870863e9.js.map