webpackJsonp([30],{"+VPp":function(e,t){},R9WL:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("y6zN"),s=a("mmiC"),i=a("OlMY"),o=a("oAV5"),n=a.n(o),u={components:{TableImage:i.a},data:function(){var e="positive";return"1"===this.$route.query.reverse&&(e="reverse"),{loading:!0,isEmpty:!1,isNoPower:!1,listData:{},stores:[],stores_id:"",user_type:"",keyword:"",order:e,token:{}}},computed:{exportHref:function(){var e={user_id:this.token.id,user_type:"1",keyword:""},t=Object.assign({},e,this.$route.query);return delete t.pageNum,delete t.pageSize,"/goodfield/web/entrancereport/export?"+Object.keys(t).map(function(e){return e+"="+(t[e]||"")}).join("&")}},watch:{stores_id:function(e){this.easyQuery({pageNum:0,stores_id:void 0===e?"":String(e)})},user_type:function(e){this.easyQuery({pageNum:0,user_type:void 0===e?"1":String(e)})},keyword:function(e){this.easyQuery({pageNum:0,keyword:e||""})},$route:function(e){var t=e.query;this.getList(Object.assign({},t)),t.positive?this.order="positive":t.reverse&&(this.order="reverse")}},mounted:function(){this.token=Object(r.a)(),this.getList(Object.assign({},this.$route.query))},methods:{handleSearch:n.a.throttle(function(e){this.keyword=e.target.value},1e3,{leading:!1}),positive:function(){this.easyQuery({positive:"1",reverse:""})},reverse:function(){this.easyQuery({positive:"",reverse:"1"})},easyQuery:function(e){var t=this.$route.query,a=Object.assign({},t,e);this.$router.push({path:this.$route.path,query:a})},getList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,t.user_id=this.token.id,t.pageNum=t.pageNum||0,t.pageSize=t.pageSize||10,t.user_type=t.user_type||1,Object(s.a)(t).then(function(t){200===Number(t.code)?(e.isEmpty=!1,e.listData=e.countIndex(t),e.stores=t.roles):201===Number(t.code)?(e.isEmpty=!0,e.listData={},e.stores=t.data):202===Number(t.code)?(e.isEmpty=!0,e.listData={},e.isNoPower=!0):(e.listData={},e.isEmpty=!0,e.$message({message:t.message,type:"warning"})),e.loading=!1}).catch(function(){e.isEmpty=!0,e.listData={},e.loading=!1})},countIndex:function(e){var t=e.pageSize,a=e.pageNum,r=e.data;return r instanceof Array?r.forEach(function(e,r){e.index=t*a+r+1}):(r.index=1,r=[r]),e},pageNumChange:function(e){this.easyQuery({pageNum:String(e-1)})},pageSizeChange:function(e){this.easyQuery({pageNum:String(0),pageSize:e})}}},l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"screen-container"},[e.isNoPower?r("div",{staticClass:"screen-empty"},[r("img",{attrs:{src:a("9Xu7"),alt:"empty_logo"}}),e._v(" "),r("p",{staticClass:"empty-title"},[e._v("没有模块权限，请与管理员确认")])]):r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"screen-body"},[r("div",{staticClass:"screen-body-header"},[r("Select",{staticClass:"query-select",staticStyle:{width:"200px"},attrs:{size:"default",clearable:!0,placeholder:"会员",transfer:!1,value:e.$route.query.user_type},on:{"on-change":function(t){e.user_type=t}}},[r("Option",{attrs:{value:"0"}},[e._v("曾会员")]),e._v(" "),r("Option",{attrs:{value:"1"}},[e._v("会员")]),e._v(" "),r("Option",{attrs:{value:"2"}},[e._v("非会员")])],1),e._v(" "),r("Input",{staticStyle:{width:"200px"},attrs:{size:"default",prefix:"ios-search",placeholder:"姓名/ID/卡号搜索",value:e.$route.query.keyword},on:{"on-change":e.handleSearch}}),e._v(" "),e.listData.data&&e.listData.data.length?r("a",{staticClass:"export-table",attrs:{href:e.exportHref}},[e._v("导出表格")]):e._e(),e._v(" "),r("div",{staticClass:"button-group"},[r("div",{staticClass:"order-btn",class:{"active-order":"positive"===e.order},on:{click:e.positive}},[r("span",[e._v("正序")]),e._v(" "),r("i",{staticClass:"order-icon"})]),e._v(" "),r("div",{staticClass:"order-btn",class:{"active-order":"reverse"===e.order},on:{click:e.reverse}},[r("span",[e._v("倒序")]),e._v(" "),r("i",{staticClass:"order-icon order-reverse"})])])],1),e._v(" "),r("div",{staticClass:"screen-body-container"},[r("el-table",{staticClass:"list",staticStyle:{"text-align":"center"},attrs:{"header-cell-style":{"text-align":"center"},height:"100%",data:e.listData.data,border:""}},[r("el-table-column",{attrs:{prop:"index",width:"70",label:"序号"}}),e._v(" "),r("el-table-column",{attrs:{prop:"user_name",label:"会员姓名"}}),e._v(" "),r("el-table-column",{attrs:{prop:"stores_name",label:"门店"}}),e._v(" "),r("el-table-column",{attrs:{prop:"userId",label:"会员ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",[t.row.userId?r("span",[e._v(e._s(t.row.userId))]):r("span",[e._v("-/-")])])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"user_card",label:"卡号"}}),e._v(" "),r("el-table-column",{attrs:{prop:"user_pic",label:"头像"},scopedSlots:e._u([{key:"default",fn:function(t){return["2"!==e.$route.query.user_type?r("table-image",{attrs:{"table-image-url":t.row.user_pic}},[r("img",{staticClass:"user-avatar",attrs:{src:t.row.user_pic,alt:"user-avatar"}})]):r("span",[e._v(e._s(t.row.user_pic))])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"exclusive",label:"入场次数"},scopedSlots:e._u([{key:"default",fn:function(t){return[2!==Number(e.$route.query.user_type)?r("router-link",{attrs:{to:{path:"/user/report/member/"+t.row.userId,query:e.$route.query},"active-class":"active-tab"}},[e._v("\n              "+e._s(t.row.frequency)+"\n            ")]):r("router-link",{attrs:{to:{path:"/user/report/member/"+t.row.id,query:e.$route.query},"active-class":"active-tab"}},[e._v("\n              "+e._s(t.row.frequency)+"\n            ")])]}}])})],1)],1),e._v(" "),e.listData.data&&e.listData.data.length>0?r("div",{staticClass:"screen-body-footer"},[r("Page",{attrs:{total:Number(e.listData.total),current:Number(e.listData.pageNum)+1,"page-size":Number(e.listData.pageSize),"show-sizer":"","show-elevator":"","show-total":"",transfer:!1},on:{"on-change":e.pageNumChange,"on-page-size-change":e.pageSizeChange}})],1):e._e()])])},staticRenderFns:[]};var c=a("VU/8")(u,l,!1,function(e){a("+VPp")},"data-v-5fa219b4",null);t.default=c.exports}});
//# sourceMappingURL=30.b95183ddddcf6cfee56c.js.map