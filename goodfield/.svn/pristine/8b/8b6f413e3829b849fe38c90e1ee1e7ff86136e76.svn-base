webpackJsonp([17],{"3H/H":function(t,e){},"9OtU":function(t,e){},PJ2m:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("vMJZ"),i=a("SJI6"),o=a("oAV5"),r=a.n(o),n=a("/o5o"),l=a("hNqL"),c=a("cMGX"),d=a("/pQn"),u={components:{Modal:n.a,Toast:l.a},props:{createModalStatus:Boolean,modalType:String},data:function(){return{formValidate:{username:this.$store.state.currentEditUser.hasOwnProperty("username")?this.$store.state.currentEditUser.username:"",account:this.$store.state.currentEditUser.hasOwnProperty("account")?this.$store.state.currentEditUser.account:"",phone:this.$store.state.currentEditUser.hasOwnProperty("phone")?this.$store.state.currentEditUser.phone:""},ruleValidate:{username:Object(d.e)(),account:Object(d.a)(),phone:Object(d.d)()},toastStatus:!1,toastData:{}}},computed:{modalTitle:function(){return"create"===this.modalType?"创建用户":"edit"===this.modalType?"编辑用户":void 0},hasEditUserData:function(){return this.formValidate.username!==this.$store.state.currentEditUser.username||this.formValidate.phone!==this.$store.state.currentEditUser.phone}},methods:{handleCancel:function(){this.$refs.formValidate.resetFields(),this.$emit("hideModal")},handleConfirm:function(){var t=this;this.$refs.formValidate.validate(function(e){e&&("edit"===t.modalType?t.editUser():"create"===t.modalType&&t.createUser())})},editUser:function(){var t=this;if(this.hasEditUserData){var e={id:this.$store.state.currentEditUser.hasOwnProperty("id")?this.$store.state.currentEditUser.id:"",username:this.formValidate.username,phone:this.formValidate.phone};Object(s.f)(e).then(function(e){"200"===e.code?(t.$message({message:e.message,type:"success"}),t.$refs.formValidate.resetFields(),t.$emit("editSuccess"),t.$emit("hideModal")):t.$message({message:e.message,type:"error"})})}else this.handleCancel()},createUser:function(){var t=this;Object(s.c)(this.formValidate).then(function(e){"200"===e.code?(t.$message({message:"用户创建成功！可在权限管理模块给该用户编辑门店和设置权限",type:"success",duration:5e3}),t.setToastData({message:e.message,callback:function(){t.$refs.formValidate.resetFields(),t.$emit("createSuccess"),t.$emit("hideModal")}})):t.setToastData({message:e.message,type:"fail"})})},setToastData:function(t){var e=this,a=t.message,s=t.type,i=t.callback;this.toastStatus=!0,this.$set(this.toastData,"message",a),this.$set(this.toastData,"type",s),setTimeout(function(){e.toastStatus=!1,i&&i()},1200)}}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("modal",{directives:[{name:"show",rawName:"v-show",value:t.createModalStatus,expression:"createModalStatus"}],attrs:{"modal-title":t.modalTitle},on:{cancelModal:t.handleCancel,confirmModal:t.handleConfirm}},[a("Form",{ref:"formValidate",staticClass:"create-form",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":100}},[a("FormItem",{attrs:{label:"用户姓名",prop:"username"}},[a("Input",{staticStyle:{width:"300px"},attrs:{maxlength:16,clearable:"",size:"default",placeholder:"用户姓名必须是2-16位中文或字母"},model:{value:t.formValidate.username,callback:function(e){t.$set(t.formValidate,"username",e)},expression:"formValidate.username"}})],1),t._v(" "),a("FormItem",{attrs:{label:"登录账号",prop:"account"}},[a("Input",{staticStyle:{width:"300px"},attrs:{maxlength:20,disabled:"edit"===t.modalType,clearable:"edit"!==t.modalType,size:"default",placeholder:"登录账号必须是6-20位，确认后账号将不可修改"},model:{value:t.formValidate.account,callback:function(e){t.$set(t.formValidate,"account",e)},expression:"formValidate.account"}})],1),t._v(" "),a("FormItem",{attrs:{label:"绑定手机号码",prop:"phone"}},[a("Input",{staticStyle:{width:"300px"},attrs:{maxlength:11,clearable:"",size:"default",placeholder:"手机号码必须是11位"},model:{value:t.formValidate.phone,callback:function(e){t.$set(t.formValidate,"phone",e)},expression:"formValidate.phone"}})],1)],1),t._v(" "),t.toastStatus?a("toast",{attrs:{message:t.toastData.message,type:t.toastData.type}}):t._e()],1)},staticRenderFns:[]};var p=a("VU/8")(u,h,!1,function(t){a("9OtU")},"data-v-5f1dbbfd",null).exports,m=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(t[s]=a[s])}return t},g={components:{CreateOrEdit:p,Modal:n.a,Toast:l.a,GPagination:c.a},data:function(){return{listData:[],paganition:{},keyword:this.$route.query.keyword,loading:!0,deleteId:0,createModalStatus:!1,deleteModalStatus:!1,modalType:"",toastStatus:!1,toastData:{}}},computed:{hasMatchKeywordListData:function(){return!!(this.keyword.length&&this.listData.length<=0)}},watch:{$route:function(){var t=this.$route.query,e=t.keyword,a=t.pageNum,s=t.pageSize;Object.is(a,void 0)&&Object.is(s,void 0)&&Object.is(e,void 0)?this.$router.replace({path:this.$route.path,query:{pageNum:0,pageSize:10,keyword:""}}):this.getListData(this.$route.query)}},beforeCreate:function(){var t=this.$route.query,e=t.keyword,a=t.pageNum,s=t.pageSize;Object.is(a,void 0)&&Object.is(s,void 0)&&Object.is(e,void 0)&&this.$router.replace({path:this.$route.path,query:{pageNum:0,pageSize:10,keyword:""}})},mounted:function(){this.getListData(this.$route.query)},methods:m({easyQuery:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.$route.query,a=Object.assign({},e,t);this.$router.push({path:this.$route.path,query:a})},changeCurrentPage:function(t){var e=t.pageNum;this.easyQuery({pageNum:e})},changeCurrentSize:function(t){var e=t.pageSize;this.easyQuery({pageNum:"0",pageSize:e})},inputContent:r.a.throttle(function(){this.easyQuery({keyword:this.keyword,pageNum:0})},1e3,{leading:!1}),getListData:function(t){var e=this;this.loading=!0,Object(s.e)(t).then(function(t){"200"===t.code?(e.listData=e.handleListData(t),e.paganition={currentPage:Number(t.pageNum)+1,pageSize:Number(t.pageSize),total:Number(t.total)}):e.listData=[],e.loading=!1}).catch(function(){e.loading=!1})},handleListData:function(t){var e=t.data,a=t.pageSize,s=t.pageNum;return e.forEach(function(t,e){t.index=a*s+e+1}),e},deleteUser:function(){var t=this;Object(s.d)({id:this.deleteId}).then(function(e){"200"===e.code?(t.$message({message:e.message,type:"success"}),t.deleteModalStatus=!1,t.getListData(t.$route.query)):"201"!==e.data&&t.$message({message:e.message,type:"error"})})},showDeleteModal:function(t){this.deleteId=t,this.deleteModalStatus=!0},showModal:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";"edit"===t&&this.setCurrentEditUser(e),this.modalType=t,this.createModalStatus=!0},hideModal:function(){this.setCurrentEditUser({}),this.createModalStatus=!1},setToastData:function(t){var e=this,a=t.message,s=t.type,i=t.callback;this.toastStatus=!0,this.$set(this.toastData,"message",a),this.$set(this.toastData,"type",s),setTimeout(function(){e.toastStatus=!1,i&&i()},1200)}},Object(i.mapMutations)({setCurrentEditUser:"SET_CURRENT_EDIT_USER"}))},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"list"},[a("div",{staticClass:"list-header"},[a("h3",{staticClass:"list-title"},[t._v("用户管理")]),t._v(" "),a("div",{staticClass:"list-header-right"},[a("i-input",{staticClass:"search-input",staticStyle:{width:"360px"},attrs:{size:"large",placeholder:"可搜索用户名、登录账号、绑定手机"},on:{input:t.inputContent},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}},[t._v("\n        >\n        "),a("Icon",{attrs:{slot:"prefix",type:"ios-search-outline"},slot:"prefix"})],1),t._v(" "),a("div",{staticClass:"add-container"},[a("span",{staticClass:"add-icon",on:{click:function(e){t.showModal("create")}}}),t._v(" "),a("span",{staticClass:"add-text",on:{click:function(e){t.showModal("create")}}},[t._v("创建用户")])])],1)]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[t.listData.length?a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.listData,border:""}},[a("el-table-column",{attrs:{prop:"index",label:"序号",align:"center",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"username",align:"center",label:"用户姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"account",align:"center",label:"登录账号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"phone",align:"center",label:"绑定手机号码"}}),t._v(" "),a("el-table-column",{attrs:{prop:"operation",width:"260",align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[a("span",{staticClass:"edit",on:{click:function(a){t.showModal("edit",e.row)}}}),t._v(" "),a("span",{staticClass:"delete",on:{click:function(a){t.showDeleteModal(e.row.id)}}})])]}}])})],1):t._e()],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&!t.listData.length,expression:"!loading && !listData.length"}],staticClass:"no-data-container"},[a("div",[t.hasMatchKeywordListData?t._e():a("div",{staticClass:"gray-logo"}),t._v(" "),t.hasMatchKeywordListData?a("p",{staticClass:"no-data-tips"},[t._v("没有匹配的数据，请修改筛选关键词")]):a("p",{staticClass:"no-data-tips"},[a("span",[t._v("还没有用户，请先")]),t._v(" "),a("span",{staticClass:"special-text",on:{click:function(e){t.showModal("create")}}},[t._v("创建用户")])])])]),t._v(" "),t.listData.length?a("g-pagination",{attrs:{total:t.paganition.total,"page-size":t.paganition.pageSize,"current-page":t.paganition.currentPage},on:{changeCurrentPage:t.changeCurrentPage,changeCurrentSize:t.changeCurrentSize}}):t._e(),t._v(" "),t.createModalStatus?a("create-or-edit",{attrs:{"modal-type":t.modalType,"create-modal-status":t.createModalStatus},on:{createSuccess:function(e){t.getListData(t.$route.query)},editSuccess:function(e){t.getListData(t.$route.query)},hideModal:t.hideModal}}):t._e(),t._v(" "),t.deleteModalStatus?a("modal",{attrs:{"modal-title":"删除提示"},on:{cancelModal:function(e){t.deleteModalStatus=!1},confirmModal:t.deleteUser}},[t._v("\n    删除该账号后，账号相关的权限将一并被删除！\n  ")]):t._e(),t._v(" "),t.toastStatus?a("toast",{attrs:{message:t.toastData.message,type:t.toastData.type}}):t._e()],1)},staticRenderFns:[]};var v=a("VU/8")(g,f,!1,function(t){a("3H/H")},"data-v-461d3690",null);e.default=v.exports}});
//# sourceMappingURL=17.0e682daa2c60bc7c4085.js.map