{"version":3,"sources":["webpack:///src/views/admin/setting/BindPhone.vue","webpack:///./src/views/admin/setting/BindPhone.vue?5b5a","webpack:///./src/views/admin/setting/BindPhone.vue"],"names":["BindPhone","components","Toast","Breadcrumb","data","passPhoneForm","oldPassword","phone","passPhoneRules","Object","formvalidate","captchaForm","captcha","captchaRules","toastStatus","toastData","sendSmsStatus","sendSmsTips","count","methods","_extends","sendSms","_this","this","$refs","validate","valid","form","password","cutdownTime","common","then","res","code","setToastData","message","type","cancel","resetFields","confirm","_this2","valid1","valid2","admin","loginData","tool","setLoginData","callback","timer","setTimeout","clearTimeout","_ref","_this3","$set","external__Vuex_","setting_BindPhone","render","_vm","_h","$createElement","_c","_self","_v","staticClass","ref","attrs","model","rules","label-position","label-width","staticStyle","width","label","prop","maxlength","placeholder","value","$$v","expression","position","class","active","on","click","_s","_e","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/29.5eab06eacbf605adc747.js","sourcesContent":["<template>\n  <div>\n    <breadcrumb></breadcrumb>\n    <div class=\"form-container\">\n      <h4 class=\"form-title\">绑定手机</h4>\n      <el-form class=\"form\" :model=\"passPhoneForm\" :rules=\"passPhoneRules\" ref=\"passPhoneForm\" label-position=\"left\" label-width=\"120px\">\n        <el-form-item style='width: 350px' label=\"原密码:\" prop=\"oldPassword\">\n          <el-input :maxlength=\"20\" placeholder=\"密码由 8 - 20 位字母和数字组成\" type='password' v-model=\"passPhoneForm.oldPassword\"></el-input>\n        </el-form-item>\n        <el-form-item style='width: 350px; position: relative' label=\"新绑定号码:\" prop=\"phone\">\n          <el-input placeholder=\"手机号码必须是11位\" :maxlength=\"11\" v-model=\"passPhoneForm.phone\"></el-input>\n          <span @click=\"sendSms\" :class=\"{active: sendSmsStatus}\" class=\"send-code\">{{sendSmsTips}}</span>\n        </el-form-item>\n      </el-form>\n      <el-form class=\"form\" :model=\"captchaForm\" :rules=\"captchaRules\" ref=\"captchaForm\" label-position=\"left\" label-width=\"120px\">\n        <el-form-item style='width: 350px' label=\"验证码:\" prop=\"captcha\">\n          <el-input placeholder=\"验证码必须是6位\"  :maxlength='6' v-model=\"captchaForm.captcha\"></el-input>\n        </el-form-item>\n      </el-form>\n      <div class=\"form-footer\">\n        <span @click='cancel' class='cancel-button'>重置</span>\n        <span @click='confirm' class='confirm-button'>确定</span>\n      </div>\n\n      <toast\n        v-if='toastStatus'\n        :message='toastData.message'\n        :type='toastData.type'>\n      </toast>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { sendAdminSms } from 'api/common'\nimport {updateAdminPhone} from 'api/admin'\nimport { getToken, setToken, logout } from 'utils/tool'\nimport { mapMutations } from 'vuex'\nimport { checkPassword, checkCaptcha, checkPhone } from 'utils/formvalidate'\n\nimport Breadcrumb from './../components/Breadcrumb'\nimport Toast from 'components/Toast'\nexport default {\n  components: {Toast, Breadcrumb},\n  data () {\n    return {\n      // 发送验证码时，会先验证密码和手机是否存在\n      passPhoneForm: {\n        oldPassword: '',\n        phone: ''\n      },\n      passPhoneRules: {\n        oldPassword: checkPassword(),\n        phone: checkPhone()\n      },\n\n      captchaForm: {\n        captcha: ''\n      },\n      captchaRules: {\n        captcha: checkCaptcha()\n      },\n\n      toastStatus: false,\n      toastData: {},\n\n      sendSmsStatus: false,\n      sendSmsTips: '发送验证码',\n      count: 60 // 倒计时60秒\n    }\n  },\n\n  methods: {\n    sendSms () {\n      this.$refs.passPhoneForm.validate(valid => {\n        if (valid && !this.sendSmsStatus) {\n          let form = {\n            password: this.passPhoneForm.oldPassword,\n            phone: this.passPhoneForm.phone\n          }\n          this.cutdownTime()\n          sendAdminSms(form).then(res => {\n            if (res.code === '200') {\n              this.setToastData({\n                message: res.message,\n                type: 'success'\n              })\n            } else {\n              this.setToastData({\n                message: res.message,\n                type: 'fail'\n              })\n            }\n          })\n        }\n      })\n    },\n    cancel () {\n      this.$refs.passPhoneForm.resetFields()\n      this.$refs.captchaForm.resetFields()\n    },\n    confirm () {\n      this.$refs.passPhoneForm.validate(valid1 => {\n        this.$refs.captchaForm.validate(valid2 => {\n          if (valid1 && valid2) {\n            let form = {\n              password: this.passPhoneForm.oldPassword,\n              phone: this.passPhoneForm.phone,\n              code: this.captchaForm.captcha\n            }\n            updateAdminPhone(form).then(res => {\n              if (res.code === '200') {\n                let loginData = getToken()\n                loginData.phone = this.passPhoneForm.phone\n                setToken(loginData)\n                this.setLoginData(loginData)\n                this.$refs.passPhoneForm.resetFields()\n                this.$refs.captchaForm.resetFields()\n                this.setToastData({\n                  message: res.message,\n                  callback: () => {\n                    logout('admin')\n                  }\n                })\n              } else {\n                this.setToastData({\n                  message: res.message,\n                  type: 'fail'\n                })\n              }\n            })\n          }\n        })\n      })\n    },\n\n    cutdownTime () {\n      this.sendSmsStatus = true\n      this.sendSmsTips = `倒计时${this.count}秒`\n      this.count = this.count - 1\n      this.timer = setTimeout(this.cutdownTime, 1000)\n      if (this.count < 0) {\n        this.sendSmsTips = '发送验证码'\n        this.count = 60\n        this.sendSmsStatus = false\n        clearTimeout(this.timer)\n      }\n    },\n\n    setToastData ({message, type, callback}) {\n      this.toastStatus = true\n      this.$set(this.toastData, 'message', message)\n      this.$set(this.toastData, 'type', type)\n      setTimeout(() => {\n        this.toastStatus = false\n        callback()\n      }, 1200)\n    },\n    ...mapMutations({\n      setLoginData: 'SET_LOGIN_DATA'\n    })\n  }\n}\n</script>\n\n<style lang=\"stylus\" scoped>\n    .form\n        margin-left 20px\n    .form-title\n        font-weight normal\n        padding-left 16px\n        margin 30px auto\n        height 23px\n        line-height 23px\n        border-left 4px solid #24CF5F\n        font-size 16px\n        color #666666\n    .send-code\n        position absolute\n        top 0\n        left 240px\n        width 90px\n        height 33px\n        line-height 33px\n        border-radius 4px\n        text-align center\n        color #ffffff\n        background-color rgba(36,207,95,1)\n        cursor pointer\n        &.active\n            color #999999\n            background-color #EAEAEA\n    .form-footer\n        display flex\n        margin-left 140px\n        padding 20px 0\n        text-align center\n        border none\n        font-size 14px\n    .cancel-button,.confirm-button\n        display inline-block\n        width 110px\n        height 35px\n        line-height 35px\n        text-align center\n        border-radius 35px\n        cursor pointer\n    .cancel-button\n        margin-right 30px\n        color #666666\n        background-color #eaeaea\n        box-shadow 1px 1px 5px #eaeaea\n    .confirm-button\n        color #ffffff\n        background-color rgba(36,207,95,1)\n        box-shadow 1px 1px 5px rgba(36,207,95,1)\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/admin/setting/BindPhone.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('breadcrumb'),_vm._v(\" \"),_c('div',{staticClass:\"form-container\"},[_c('h4',{staticClass:\"form-title\"},[_vm._v(\"绑定手机\")]),_vm._v(\" \"),_c('el-form',{ref:\"passPhoneForm\",staticClass:\"form\",attrs:{\"model\":_vm.passPhoneForm,\"rules\":_vm.passPhoneRules,\"label-position\":\"left\",\"label-width\":\"120px\"}},[_c('el-form-item',{staticStyle:{\"width\":\"350px\"},attrs:{\"label\":\"原密码:\",\"prop\":\"oldPassword\"}},[_c('el-input',{attrs:{\"maxlength\":20,\"placeholder\":\"密码由 8 - 20 位字母和数字组成\",\"type\":\"password\"},model:{value:(_vm.passPhoneForm.oldPassword),callback:function ($$v) {_vm.$set(_vm.passPhoneForm, \"oldPassword\", $$v)},expression:\"passPhoneForm.oldPassword\"}})],1),_vm._v(\" \"),_c('el-form-item',{staticStyle:{\"width\":\"350px\",\"position\":\"relative\"},attrs:{\"label\":\"新绑定号码:\",\"prop\":\"phone\"}},[_c('el-input',{attrs:{\"placeholder\":\"手机号码必须是11位\",\"maxlength\":11},model:{value:(_vm.passPhoneForm.phone),callback:function ($$v) {_vm.$set(_vm.passPhoneForm, \"phone\", $$v)},expression:\"passPhoneForm.phone\"}}),_vm._v(\" \"),_c('span',{staticClass:\"send-code\",class:{active: _vm.sendSmsStatus},on:{\"click\":_vm.sendSms}},[_vm._v(_vm._s(_vm.sendSmsTips))])],1)],1),_vm._v(\" \"),_c('el-form',{ref:\"captchaForm\",staticClass:\"form\",attrs:{\"model\":_vm.captchaForm,\"rules\":_vm.captchaRules,\"label-position\":\"left\",\"label-width\":\"120px\"}},[_c('el-form-item',{staticStyle:{\"width\":\"350px\"},attrs:{\"label\":\"验证码:\",\"prop\":\"captcha\"}},[_c('el-input',{attrs:{\"placeholder\":\"验证码必须是6位\",\"maxlength\":6},model:{value:(_vm.captchaForm.captcha),callback:function ($$v) {_vm.$set(_vm.captchaForm, \"captcha\", $$v)},expression:\"captchaForm.captcha\"}})],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"form-footer\"},[_c('span',{staticClass:\"cancel-button\",on:{\"click\":_vm.cancel}},[_vm._v(\"重置\")]),_vm._v(\" \"),_c('span',{staticClass:\"confirm-button\",on:{\"click\":_vm.confirm}},[_vm._v(\"确定\")])]),_vm._v(\" \"),(_vm.toastStatus)?_c('toast',{attrs:{\"message\":_vm.toastData.message,\"type\":_vm.toastData.type}}):_vm._e()],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-70fddc6b\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/admin/setting/BindPhone.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-70fddc6b\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./BindPhone.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./BindPhone.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./BindPhone.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-70fddc6b\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./BindPhone.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-70fddc6b\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/admin/setting/BindPhone.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}